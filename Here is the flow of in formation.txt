Here is the flow of in formation:
1.
    def analyze_pankti(self):
        """
        1) Get user’s typed verse/pankti.
        2) Fuzzy-match it against SGGS data.
        3) Show radio buttons for each match so user can select exactly one.
        """
        user_input = self.pankti_entry.get().strip()
        if not user_input:
            messagebox.showerror("Error", "Please enter some text to analyze.")
            return

        # 1) Fuzzy-match the verse in SGGS data (example function)
        candidate_matches = self.match_sggs_verse(user_input)
        if not candidate_matches:
            messagebox.showinfo("No SGGS Match", "No matching verses found in SGGS. Continuing with grammar analysis.")
            # If you still want to do grammar analysis with the typed input:
            self.finish_grammar_analysis(user_input)
            return
        else:
            # Show a new window with radio buttons
            self.show_sggs_matches_option(candidate_matches, user_input)
Note:
We'll need to update 'self.pankti_entry' with the user input.

Here is the values of various variables in this function:
user_input = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥' (a verse I chose that alredy exists in our excell file)
candidate_matches = (['S. No.', 'Verse', 'Verse No.', 'Stanza No.', 'Text Set No.', 'Raag (Fixed)', 'Sub-Raag', 'Writer (Fixed)', 'Verse Configuration (Optional)', 'Stanza Configuration (Optional)', 'Bani Name', 'Musical Note Configuration', 'Special Type Demonstrator', 'Type', 'Page Number'], [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}])



2.
    def match_sggs_verse(self, user_input, max_results=10, min_score=60):
        """
        Fuzzy-match the user's input (pankti) against the SGGS 'Verse' column.
        Return a tuple (headers, candidate_matches) where headers is the list
        of all column names from the Excel file, and candidate_matches is a list
        (up to max_results) of best matches above the min_score similarity.
        """
        # Ensure we have loaded the data and headers
        if not hasattr(self, 'sggs_data'):
            self.load_sggs_data()
        
        headers = self.sggs_headers
        normalized_input = user_input.lower().strip()
        candidate_matches = []

        # Disable the main window to block user interaction during matching
        self.root.attributes("-disabled", True)
        # Start the modal progress bar
        self.start_progress()
        self.root.update()  # Ensure progress window appears

        total_rows = len(self.sggs_data)
        # Iterate over the rows in SGGS data
        for i, (_, row) in enumerate(self.sggs_data.iterrows()):
            verse_text = row['NormalizedVerse']
            # Remove extra spaces around numbers within "॥" markers
            verse_text = re.sub(r'॥\s*(\d+)\s*॥', r'॥\1॥', verse_text)
            score = fuzz.token_sort_ratio(normalized_input, verse_text)
            if score >= min_score:
                candidate_matches.append({
                    'S. No.': row['S. No.'],
                    'Verse': row['Verse'],
                    'Verse No.': row.get('Verse No.'),
                    'Stanza No.': row['Stanza No.'],
                    'Text Set No.': row.get('Text Set No.'),
                    'Raag (Fixed)': row['Raag (Fixed)'],
                    'Sub-Raag': row.get('Sub-Raag'),
                    'Writer (Fixed)': row['Writer (Fixed)'],
                    'Verse Configuration (Optional)': row.get('Verse Configuration (Optional)'),
                    'Stanza Configuration (Optional)': row.get('Stanza Configuration (Optional)'),
                    'Bani Name': row['Bani Name'],
                    'Musical Note Configuration': row.get('Musical Note Configuration'),
                    'Special Type Demonstrator': row.get('Special Type Demonstrator'),
                    'Type': row.get('Type'),
                    'Page Number': row['Page Number'],
                    'Score': score
                })
            if i % 50 == 0:
                self.root.update_idletasks()
                self.root.update()

        # Sort the candidate matches by descending score and select the top results.
        candidate_matches.sort(key=lambda x: x['Score'], reverse=True)

        # Stop the progress bar and re-enable the main window.
        self.stop_progress()
        self.root.attributes("-disabled", False)

        return headers, candidate_matches[:max_results]

Here is the values of various variables in this function:
headers = ['S. No.', 'Verse', 'Verse No.', 'Stanza No.', 'Text Set No.', 'Raag (Fixed)', 'Sub-Raag', 'Writer (Fixed)', 'Verse Configuration (Optional)', 'Stanza Configuration (Optional)', 'Bani Name', 'Musical Note Configuration', 'Special Type Demonstrator', 'Type', 'Page Number']
normalized_input = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'
candidate_matches = [{'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'Score': 100.0}, {'S. No.': 30036, 'Verse': 'ਸਭਿ ਅਵਗਣ ਮੈ ਗੁਣੁ ਨਹੀ ਕੋਈ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 2020, 'Raag (Fixed)': 'ਸੂਹੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 750, 'Score': 73.07692307692308}, {'S. No.': 45945, 'Verse': 'ਤੇਰੀ ਟੇਕ ਨਾਹੀ ਭਉ ਕੋਇ ॥', 'Verse No.': 11, 'Stanza No.': 4, 'Text Set No.': 2887, 'Raag (Fixed)': 'ਭੈਰਉ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1147, 'Score': 70.83333333333333}, {'S. No.': 52910, 'Verse': 'ਗੁਰ ਸਮਾਨਿ ਤੀਰਥੁ ਨਹੀ ਕੋਇ ॥', 'Verse No.': 3, 'Stanza No.': 2, 'Text Set No.': 3463, 'Raag (Fixed)': 'ਪਰਭਾਤੀ ਬਿਭਾਸ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1328, 'Score': 70.58823529411764}, {'S. No.': 32796, 'Verse': 'ਮੈ ਨਾਹੀ ਪ੍ਰਭ ਸਭੁ ਕਿਛੁ ਤੇਰਾ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 2231, 'Raag (Fixed)': 'ਬਿਲਾਵਲੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਦੁਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੮', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 827, 'Score': 70.37037037037037}, {'S. No.': 2155, 'Verse': 'ਸਭਿ ਗੁਣਵੰਤੀ ਆਖੀਅਹਿ ਮੈ ਗੁਣੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 24, 'Stanza No.': 9, 'Text Set No.': 120, 'Raag (Fixed)': 'ਸਿਰੀਰਾਗੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 56, 'Score': 69.84126984126983}, {'S. No.': 15339, 'Verse': 'ਤੁਝ ਤੇ ਵਡਾ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 5, 'Stanza No.': 1, 'Text Set No.': 866, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': 'ਤਿਤੁਕਾ', 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 354, 'Score': 68.08510638297872}, {'S. No.': 50635, 'Verse': 'ਗੁਰੁ ਮਾਨੈ ਮਾਨੈ ਸਭੁ ਕੋਇ ॥', 'Verse No.': 19, 'Stanza No.': 6, 'Text Set No.': 3267, 'Raag (Fixed)': 'ਮਲਾਰ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1262, 'Score': 68.0}, {'S. No.': 16765, 'Verse': 'ਮੈ ਨਿਰਗੁਨ ਗੁਣੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 3, 'Stanza No.': 2, 'Text Set No.': 984, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੭', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 388, 'Score': 66.66666666666667}, {'S. No.': 32749, 'Verse': 'ਕਿਆ ਗੁਣ ਤੇਰੇ ਸਾਰਿ ਸਮ੍ਹ੍ਹਾਰੀ ॥', 'Verse No.': 5, 'Stanza No.': 3, 'Text Set No.': 2223, 'Raag (Fixed)': 'ਬਿਲਾਵਲੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੭', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 826, 'Score': 65.45454545454545}, {'S. No.': 40974, 'Verse': 'ਬਿਨੁ ਗੁਰ ਪਰਮੇਸਰ ਕੋਈ ਨਾਹੀ ॥', 'Verse No.': 32, 'Stanza No.': 11, 'Text Set No.': 2660, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1028, 'Score': 65.38461538461539}, {'S. No.': 52852, 'Verse': 'ਨਾਇ ਤੇਰੈ ਨਾਉ ਮੰਨੇ ਸਭ ਕੋਇ ॥', 'Verse No.': 3, 'Stanza No.': 1, 'Text Set No.': 3458, 'Raag (Fixed)': 'ਪਰਭਾਤੀ ਬਿਭਾਸ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1327, 'Score': 65.38461538461539}, {'S. No.': 36855, 'Verse': 'ਗੁਣ ਬੇਅੰਤ ਸੁਆਮੀ ਤੇਰੇ ਕੋਇ ਨ ਜਾਨਈ ॥', 'Verse No.': 13, 'Stanza No.': 3, 'Text Set No.': 2454, 'Raag (Fixed)': 'ਰਾਮਕਲੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਛੰਤੁ', 'Type': 'Simple', 'Page Number': 925, 'Score': 64.40677966101696}, {'S. No.': 41906, 'Verse': 'ਤੇਰੇ ਗੁਣ ਬਹੁਤੇ ਮੈ ਏਕੁ ਨ ਜਾਤਾ ॥', 'Verse No.': 4, 'Stanza No.': 2, 'Text Set No.': 2680, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1049, 'Score': 64.28571428571428}, {'S. No.': 34205, 'Verse': 'ਗੁਰ ਕਾ ਸਬਦੁ ਨ ਮੇਟੈ ਕੋਇ ॥', 'Verse No.': 17, 'Stanza No.': 5, 'Text Set No.': 2313, 'Raag (Fixed)': 'ਗੋਂਡ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 864, 'Score': 64.0}, {'S. No.': 43280, 'Verse': 'ਰਸਨਾ ਗੁਣ ਗਾਵੈ ਹਰਿ ਤੇਰੇ ॥', 'Verse No.': 10, 'Stanza No.': 4, 'Text Set No.': 2709, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1080, 'Score': 64.0}, {'S. No.': 23761, 'Verse': 'ਮੋਹਿ ਨਿਰਗੁਣ ਜੀਉ ਸਭਿ ਗੁਣ ਤੇਰੇ ਰਾਮ ॥', 'Verse No.': 20, 'Stanza No.': 4, 'Text Set No.': 1470, 'Raag (Fixed)': 'ਵਡਹੰਸੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੪', 'Special Type Demonstrator': 'ਛੰਤੁ', 'Type': 'Simple', 'Page Number': 577, 'Score': 63.33333333333333}, {'S. No.': 44764, 'Verse': 'ਇਹੁ ਤਨੁ ਮਨੁ ਤੇਰਾ ਸਭਿ ਗੁਣ ਤੇਰੇ ॥', 'Verse No.': 7, 'Stanza No.': 2, 'Text Set No.': 2787, 'Raag (Fixed)': 'ਤੁਖਾਰੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਛੰਤੁ', 'Type': 'Simple', 'Page Number': 1117, 'Score': 63.1578947368421}, {'S. No.': 29576, 'Verse': 'ਹਉ ਕਿਛੁ ਨਾਹੀ ਸਭੁ ਕਿਛੁ ਤੇਰਾ ॥', 'Verse No.': 9, 'Stanza No.': 5, 'Text Set No.': 1972, 'Raag (Fixed)': 'ਸੂਹੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੩', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 739, 'Score': 62.96296296296296}, {'S. No.': 42731, 'Verse': 'ਤੇਰੇ ਗੁਣ ਕਹਾ ਮੈ ਕਹਣੁ ਨ ਜਾਈ ॥', 'Verse No.': 13, 'Stanza No.': 5, 'Text Set No.': 2697, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1067, 'Score': 62.96296296296296}, {'S. No.': 49732, 'Verse': 'ਨਾਨਕ ਨਿਗੁਰਿਆ ਗੁਣੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 7, 'Stanza No.': 1, 'Text Set No.': 3206, 'Raag (Fixed)': 'ਸਾਰੰਗ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਵਾਰ', 'Type': 'Simple', 'Page Number': 1240, 'Score': 62.96296296296296}, {'S. No.': 7281, 'Verse': 'ਤਿਸ ਤੇ ਬਾਹਰਿ ਨਾਹੀ ਕੋਇ ॥ ੧ ॥', 'Verse No.': 4, 'Stanza No.': 1, 'Text Set No.': 397, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': 'ਗੁਆਰੇਰੀ', 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Stanza End', 'Page Number': 182, 'Score': 62.745098039215684}, {'S. No.': 12643, 'Verse': 'ਤਿਹੁ ਗੁਣ ਕਾ ਨਾਹੀ ਪਰਵੇਸੁ ॥', 'Verse No.': 57, 'Stanza No.': 7, 'Text Set No.': 689, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸੁਖਮਨੀ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 291, 'Score': 62.745098039215684}, {'S. No.': 42281, 'Verse': 'ਬਿਨੁ ਗੁਰ ਦਾਤੇ ਕੋਇ ਨ ਪਾਏ ॥', 'Verse No.': 43, 'Stanza No.': 15, 'Text Set No.': 2687, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1057, 'Score': 62.745098039215684}, {'S. No.': 33402, 'Verse': 'ਕੋਇ ਨ ਮੇਟੈ ਤੇਰੈ ਲੇਖੈ ॥', 'Verse No.': 10, 'Stanza No.': 3, 'Text Set No.': 2260, 'Raag (Fixed)': 'ਬਿਲਾਵਲ ਕੀ ਵਾਰ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸਤ', 'Musical Note Configuration': 'ਘਰੁ ੧੦', 'Special Type Demonstrator': 'ਵਾਰ', 'Type': 'Simple', 'Page Number': 842, 'Score': 62.5}, {'S. No.': 43529, 'Verse': 'ਜਾ ਤੇ ਬਿਰਥਾ ਕੋਊ ਨਾਹੀ ॥', 'Verse No.': 7, 'Stanza No.': 3, 'Text Set No.': 2714, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1085, 'Score': 62.5}, {'S. No.': 48320, 'Verse': 'ਤੇਰੇ ਮਿਟਹਿ ਪਾਪ ਸਭ ਕੋਟਿ ਕੋਟਿ ॥', 'Verse No.': 16, 'Stanza No.': 5, 'Text Set No.': 3031, 'Raag (Fixed)': 'ਬਸੰਤੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਰਵਿਦਾਸ ਜੀ', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1196, 'Score': 61.81818181818181}, {'S. No.': 11468, 'Verse': 'ਜਿਸੁ ਧਨ ਤੇ ਸਭੁ ਕੋ ਵਰਸਾਵੈ ॥', 'Verse No.': 49, 'Stanza No.': 6, 'Text Set No.': 675, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸੁਖਮਨੀ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 271, 'Score': 61.53846153846154}, {'S. No.': 12177, 'Verse': 'ਤਿਸ ਤੇ ਪਰੈ ਨਾਹੀ ਕਿਛੁ ਕੋਇ ॥', 'Verse No.': 6, 'Stanza No.': 2, 'Text Set No.': 684, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸੁਖਮਨੀ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 283, 'Score': 61.53846153846154}, {'S. No.': 35602, 'Verse': 'ਨਾਮ ਤੇਰੇ ਕੀ ਮਨ ਮਹਿ ਟੇਕ ॥ ੨ ॥', 'Verse No.': 10, 'Stanza No.': 3, 'Text Set No.': 2402, 'Raag (Fixed)': 'ਰਾਮਕਲੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Stanza End', 'Page Number': 894, 'Score': 61.53846153846154}, {'S. No.': 45328, 'Verse': 'ਸਭਿ ਘਟ ਤੇਰੇ ਤੂ ਸਭਨਾ ਮਾਹਿ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 2845, 'Raag (Fixed)': 'ਭੈਰਉ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੪', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1134, 'Score': 61.53846153846154}, {'S. No.': 47353, 'Verse': 'ਤਿਸ ਤੇ ਨੇੜੈ ਨਾਹੀ ਕੋ ਦੂਰਿ ॥', 'Verse No.': 17, 'Stanza No.': 5, 'Text Set No.': 2967, 'Raag (Fixed)': 'ਬਸੰਤੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': 'ਦੁਤੁਕੇ', 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1175, 'Score': 61.53846153846154}, {'S. No.': 35129, 'Verse': 'ਨਹ ਕੋ ਮੂਆ ਨ ਮਰਣੈ ਜੋਗੁ ॥', 'Verse No.': 13, 'Stanza No.': 4, 'Text Set No.': 2375, 'Raag (Fixed)': 'ਰਾਮਕਲੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 885, 'Score': 61.224489795918366}, {'S. No.': 36516, 'Verse': 'ਸਭਿ ਥਾਨ ਦੇਖੇ ਨੈਣ ਅਲੋਇ ॥', 'Verse No.': 31, 'Stanza No.': 9, 'Text Set No.': 2446, 'Raag (Fixed)': 'ਰਾਮਕਲੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 915, 'Score': 61.224489795918366}, {'S. No.': 39419, 'Verse': 'ਜਿਸ ਤੇ ਬਿਰਥਾ ਕੋਇ ਨਾਹਿ ॥', 'Verse No.': 8, 'Stanza No.': 3, 'Text Set No.': 2566, 'Raag (Fixed)': 'ਮਾਲੀ ਗਉੜਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 987, 'Score': 61.224489795918366}, {'S. No.': 42140, 'Verse': 'ਸਦਾ ਸਦਾ ਤੇਰੇ ਗੁਣ ਗਾਵਾ ॥', 'Verse No.': 46, 'Stanza No.': 16, 'Text Set No.': 2684, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1054, 'Score': 61.224489795918366}, {'S. No.': 48758, 'Verse': 'ਰਸਨਾ ਰਾਮ ਕਹਤ ਗੁਣ ਸੋਹੰ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 3085, 'Raag (Fixed)': 'ਸਾਰੰਗ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਦੁਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੪', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1211, 'Score': 61.224489795918366}, {'S. No.': 3853, 'Verse': 'ਸਭ ਕਿਛੁ ਘਰ ਮਹਿ ਬਾਹਰਿ ਨਾਹੀ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 213, 'Raag (Fixed)': 'ਮਾਝ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 102, 'Score': 60.37735849056604}, {'S. No.': 56546, 'Verse': 'ਤੇਰਾ ਕੀਤਾ ਜਾਤੋ ਨਾਹੀ ਮੈਨੋ ਜੋਗੁ ਕੀਤੋਈ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 4297, 'Raag (Fixed)': 'ਮੁੰਦਾਵਣੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਲੋਕ', 'Type': 'Simple', 'Page Number': 1429, 'Score': 60.31746031746032}, {'S. No.': 103, 'Verse': 'ਮੰਨੈ ਤਰੈ ਤਾਰੇ ਗੁਰੁ ਸਿਖ ॥', 'Verse No.': 103, 'Stanza No.': 16, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 3, 'Score': 60.0}, {'S. No.': 435, 'Verse': 'ਗੁਣੁ ਏਹੋ ਹੋਰੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 13, 'Stanza No.': 4, 'Text Set No.': 4, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸੋ ਦਰੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 9, 'Score': 60.0}, {'S. No.': 3716, 'Verse': 'ਵਰਤੈ ਸਭ ਕਿਛੁ ਤੇਰਾ ਭਾਣਾ ॥', 'Verse No.': 8, 'Stanza No.': 3, 'Text Set No.': 201, 'Raag (Fixed)': 'ਮਾਝ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 98, 'Score': 60.0}, {'S. No.': 4058, 'Verse': 'ਗੁਰ ਕੇ ਚਰਣ ਵਸੇ ਮਨ ਮਾਹੀ ॥', 'Verse No.': 2, 'Stanza No.': 1, 'Text Set No.': 230, 'Raag (Fixed)': 'ਮਾਝ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 107, 'Score': 60.0}, {'S. No.': 5109, 'Verse': 'ਕਿਆ ਗੁਣ ਤੇਰੇ ਆਖਿ ਸਮਾਲੀ ॥', 'Verse No.': 18, 'Stanza No.': 7, 'Text Set No.': 274, 'Raag (Fixed)': 'ਮਾਝ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 132, 'Score': 60.0}, {'S. No.': 6099, 'Verse': 'ਤੇਰਾ ਤਾਣੁ ਨਾਮ ਕੀ ਵਡਿਆਈ ॥', 'Verse No.': 17, 'Stanza No.': 5, 'Text Set No.': 315, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': 'ਦਖਣੀ', 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ, ਦੁਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 154, 'Score': 60.0}, {'S. No.': 12774, 'Verse': 'ਤਿਸ ਤੇ ਭਿੰਨ ਨਹੀ ਕੋ ਠਾਉ ॥', 'Verse No.': 22, 'Stanza No.': 3, 'Text Set No.': 691, 'Raag (Fixed)': 'ਗਉੜੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਸੁਖਮਨੀ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 294, 'Score': 60.0}, {'S. No.': 15105, 'Verse': 'ਗੁਣੁ ਏਹੋ ਹੋਰੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 13, 'Stanza No.': 4, 'Text Set No.': 850, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 349, 'Score': 60.0}, {'S. No.': 15191, 'Verse': 'ਮੈ ਗੁਣ ਗਲਾ ਕੇ ਸਿਰਿ ਭਾਰ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 857, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 351, 'Score': 60.0}, {'S. No.': 15202, 'Verse': 'ਤੁਝ ਬਿਨੁ ਦੂਜਾ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 12, 'Stanza No.': 4, 'Text Set No.': 857, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 351, 'Score': 60.0}, {'S. No.': 29442, 'Verse': 'ਤੁਝ ਬਿਨੁ ਦੂਜਾ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 2, 'Stanza No.': 1, 'Text Set No.': 1963, 'Raag (Fixed)': 'ਸੂਹੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 736, 'Score': 60.0}, {'S. No.': 36030, 'Verse': 'ਗੁਰ ਕੈ ਸਬਦਿ ਰਚੈ ਮਨ ਭਾਇ ॥', 'Verse No.': 9, 'Stanza No.': 3, 'Text Set No.': 2430, 'Raag (Fixed)': 'ਰਾਮਕਲੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 903, 'Score': 60.0}, {'S. No.': 43268, 'Verse': 'ਤੂ ਸਭਨਾ ਕਾ ਸਭੁ ਕੋ ਤੇਰਾ ॥', 'Verse No.': 46, 'Stanza No.': 16, 'Text Set No.': 2708, 'Raag (Fixed)': 'ਮਾਰੂ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸੋਲਹੇ', 'Type': 'Simple', 'Page Number': 1079, 'Score': 60.0}, {'S. No.': 53231, 'Verse': 'ਨਾਮੁ ਤੇਰਾ ਜਨ ਕੈ ਭੰਡਾਰਿ ॥', 'Verse No.': 3, 'Stanza No.': 1, 'Text Set No.': 3490, 'Raag (Fixed)': 'ਪਰਭਾਤੀ ਬਿਭਾਸ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1338, 'Score': 60.0}]

3.
    def show_sggs_matches_option(self, candidate_matches, user_input):
        """
        Display fuzzy SGGS matches as radio buttons so the user can choose one.
        The header will also include the user input verse.
        """

        # 1) If the first item is a header list, strip it off:
        if candidate_matches and isinstance(candidate_matches[0], list):
            # This is presumably the header row
            self.header_row = candidate_matches[0]
            # If there's a second element and it's a list of dicts, use that
            if len(candidate_matches) > 1 and isinstance(candidate_matches[1], list):
                candidate_matches = candidate_matches[1]
            else:
                # No real data after the header
                candidate_matches = []

        # 2) Store matches for later reference
        self.candidate_matches = candidate_matches

        # 3) Destroy if there's an existing option window
        if hasattr(self, 'sggs_option_window') and self.sggs_option_window.winfo_exists():
            self.sggs_option_window.destroy()

        # 4) Create a new Toplevel window
        self.sggs_option_window = tk.Toplevel(self.root)
        self.sggs_option_window.title("Select One Matching Verse")
        self.sggs_option_window.configure(bg='light gray')
        self.sggs_option_window.state("zoomed")

        # 5) A Tk variable that holds the index of the selected match
        self.sggs_option_var = tk.IntVar(value=-1)  # -1 = nothing selected

        # 6) Header label
        header_label = tk.Label(
            self.sggs_option_window,
            text=f"Fuzzy Matches Found for '{user_input}'. Please select one:",
            bg='dark slate gray',
            fg='white',
            font=('Arial', 16, 'bold'),
            pady=10
        )
        header_label.pack(fill=tk.X)

        # 7) Scrollable frame for radio buttons
        frame = tk.Frame(self.sggs_option_window, bg='light gray')
        frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)

        canvas = tk.Canvas(frame, bg='light gray', borderwidth=0)
        vsb = tk.Scrollbar(frame, orient="vertical", command=canvas.yview)
        scroll_frame = tk.Frame(canvas, bg='light gray')

        canvas.configure(yscrollcommand=vsb.set)
        canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        vsb.pack(side=tk.RIGHT, fill=tk.Y)

        canvas.create_window((0, 0), window=scroll_frame, anchor="nw")

        # 8) Populate the scroll_frame with radio buttons
        for idx, match in enumerate(candidate_matches):
            # We now expect match to be a dict. But if there's a chance
            # it might be something else, you can still do an isinstance check:
            if isinstance(match, dict):
                # Get the score value
                raw_score = match.get('Score', '?')
                # Attempt to convert it to float and format with 2 decimals
                try:
                    score_float = float(raw_score)
                    score_str = f"{score_float:.2f}"
                except ValueError:
                    # If it's not a valid float (e.g. '?'), just show it as is
                    score_str = str(raw_score)
                verse = match.get('Verse', '')
                raag = match.get('Raag (Fixed)', '')
                writer = match.get('Writer (Fixed)', '')
                bani = match.get('Bani Name', '')
                page = match.get('Page Number', '')
            else:
                # Fallback if it's not a dict, adjust indices to your structure
                score = match[7] if len(match) > 7 else '?'
                verse = match[1] if len(match) > 1 else ''
                raag = match[2] if len(match) > 2 else ''
                writer = match[3] if len(match) > 3 else ''
                bani = match[4] if len(match) > 4 else ''
                page = match[5] if len(match) > 5 else ''

            # Convert them to strings and handle 'nan' or empty strings
            def clean_value(val):
                if not val or str(val).lower() == 'nan':
                    return ''
                return str(val)

            raag = clean_value(raag)
            writer = clean_value(writer)
            bani = clean_value(bani)
            page = clean_value(page)

            # Build the info line with only non-empty fields
            info_parts = []
            if raag:
                info_parts.append(f"Raag: {raag}")
            if writer:
                info_parts.append(f"Writer: {writer}")
            if bani:
                info_parts.append(f"Bani: {bani}")
            if page:
                info_parts.append(f"Page: {page}")
            info_line = " | ".join(info_parts)

            # Build the label text
            label_text = f"Match #{idx+1} - Score: {score_str}%\nVerse: {verse}"
            if info_line:
                label_text += f"\n{info_line}"

            rb = tk.Radiobutton(
                scroll_frame, text=label_text,
                variable=self.sggs_option_var, value=idx,
                bg='light gray', anchor='w', justify=tk.LEFT,
                wraplength=800,  # adjust as needed
                font=('Arial', 12), selectcolor='light blue'
            )
            rb.pack(fill=tk.X, padx=10, pady=5)

        scroll_frame.update_idletasks()
        canvas.config(scrollregion=canvas.bbox("all"))

        # 9) Buttons
        btn_frame = tk.Frame(self.sggs_option_window, bg='light gray')
        btn_frame.pack(pady=10)

        tk.Button(
            btn_frame, text="Submit",
            command=self.handle_sggs_option_submit,
            font=('Arial', 12, 'bold'), bg='navy', fg='white',
            padx=20, pady=10
        ).pack(side=tk.LEFT, padx=10)

        tk.Button(
            btn_frame, text="Cancel",
            command=self.sggs_option_window.destroy,
            font=('Arial', 12, 'bold'), bg='red', fg='white',
            padx=20, pady=10
        ).pack(side=tk.LEFT, padx=10)

        print("Match window created and populated.")

Here is the values of various variables in this function:
self.header_row = ['S. No.', 'Verse', 'Verse No.', 'Stanza No.', 'Text Set No.', 'Raag (Fixed)', 'Sub-Raag', 'Writer (Fixed)', 'Verse Configuration (Optional)', 'Stanza Configuration (Optional)', 'Bani Name', 'Musical Note Configuration', 'Special Type Demonstrator', 'Type', 'Page Number']
self.candidate_matches = [{'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'Score': 100.0}, {'S. No.': 30036, 'Verse': 'ਸਭਿ ਅਵਗਣ ਮੈ ਗੁਣੁ ਨਹੀ ਕੋਈ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 2020, 'Raag (Fixed)': 'ਸੂਹੀ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 750, 'Score': 73.07692307692308}, {'S. No.': 45945, 'Verse': 'ਤੇਰੀ ਟੇਕ ਨਾਹੀ ਭਉ ਕੋਇ ॥', 'Verse No.': 11, 'Stanza No.': 4, 'Text Set No.': 2887, 'Raag (Fixed)': 'ਭੈਰਉ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1147, 'Score': 70.83333333333333}, {'S. No.': 52910, 'Verse': 'ਗੁਰ ਸਮਾਨਿ ਤੀਰਥੁ ਨਹੀ ਕੋਇ ॥', 'Verse No.': 3, 'Stanza No.': 2, 'Text Set No.': 3463, 'Raag (Fixed)': 'ਪਰਭਾਤੀ ਬਿਭਾਸ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1328, 'Score': 70.58823529411764}, {'S. No.': 32796, 'Verse': 'ਮੈ ਨਾਹੀ ਪ੍ਰਭ ਸਭੁ ਕਿਛੁ ਤੇਰਾ ॥', 'Verse No.': 1, 'Stanza No.': 1, 'Text Set No.': 2231, 'Raag (Fixed)': 'ਬਿਲਾਵਲੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਦੁਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੮', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 827, 'Score': 70.37037037037037}, {'S. No.': 2155, 'Verse': 'ਸਭਿ ਗੁਣਵੰਤੀ ਆਖੀਅਹਿ ਮੈ ਗੁਣੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 24, 'Stanza No.': 9, 'Text Set No.': 120, 'Raag (Fixed)': 'ਸਿਰੀਰਾਗੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੧', 'Special Type Demonstrator': 'ਅਸਟਪਦੀ', 'Type': 'Simple', 'Page Number': 56, 'Score': 69.84126984126983}, {'S. No.': 15339, 'Verse': 'ਤੁਝ ਤੇ ਵਡਾ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 5, 'Stanza No.': 1, 'Text Set No.': 866, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': 'ਤਿਤੁਕਾ', 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 354, 'Score': 68.08510638297872}, {'S. No.': 50635, 'Verse': 'ਗੁਰੁ ਮਾਨੈ ਮਾਨੈ ਸਭੁ ਕੋਇ ॥', 'Verse No.': 19, 'Stanza No.': 6, 'Text Set No.': 3267, 'Raag (Fixed)': 'ਮਲਾਰ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੩', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੨', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 1262, 'Score': 68.0}, {'S. No.': 16765, 'Verse': 'ਮੈ ਨਿਰਗੁਨ ਗੁਣੁ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 3, 'Stanza No.': 2, 'Text Set No.': 984, 'Raag (Fixed)': 'ਆਸਾ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੭', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 388, 'Score': 66.66666666666667}, {'S. No.': 32749, 'Verse': 'ਕਿਆ ਗੁਣ ਤੇਰੇ ਸਾਰਿ ਸਮ੍ਹ੍ਹਾਰੀ ॥', 'Verse No.': 5, 'Stanza No.': 3, 'Text Set No.': 2223, 'Raag (Fixed)': 'ਬਿਲਾਵਲੁ', 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੫', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': 'ਚਉਪਦੇ', 'Bani Name': nan, 'Musical Note Configuration': 'ਘਰੁ ੭', 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 826, 'Score': 65.45454545454545}]


After the above functions compete there task the user clicks 'Submit' button & below functions are called:
4.
    def handle_sggs_option_submit(self):
        idx = self.sggs_option_var.get()
        if idx < 0:
            messagebox.showwarning("No Selection", "Please select one verse match.")
            return

        chosen_match = self.candidate_matches[idx]
        final_input = chosen_match.get('Verse', '')

        if not final_input.strip():
            messagebox.showerror("Error", "The selected verse text is empty. Cannot proceed.")
            return

        # Optionally close the first match window
        self.sggs_option_window.destroy()

        # Now, show the consecutive lines selection
        self.show_consecutive_verses_option(chosen_match, final_input)

Here is the values of various variables in this function:
chosen_match = {'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'Score': 100.0}
final_input = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'


5.
    def show_consecutive_verses_option(self, chosen_match, main_verse_text):
        """
        After the user picks the main verse from fuzzy matches,
        let them select additional consecutive lines from the same stanza or text set.
        Ensure the main verse is highlighted and only consecutive verses can be selected.
        """
        # 1) Query your data to find consecutive lines
        stanza_lines = self.fetch_stanza_lines(chosen_match)
        self.chosen_match = stanza_lines
        if not stanza_lines:
            messagebox.showinfo("No Consecutive Lines", "No additional consecutive verses found. Proceeding.")
            self.finish_grammar_analysis(main_verse_text)
            return

        # 2) Store the main user input so that we can return to SGGS matches later.
        self.last_user_input = main_verse_text

        # 3) Create a window to show these lines as checkboxes
        self.consecutive_window = tk.Toplevel(self.root)
        self.consecutive_window.title("Select Consecutive Verses")
        self.consecutive_window.configure(bg='light gray')
        self.consecutive_window.state('zoomed')

        # Adjust header text based on the stored user's choice.
        if hasattr(self, 'verses_choice') and self.verses_choice:
            header_text = f"Select Additional Lines from the '{chosen_match['Special Type Demonstrator']}'"
        else:
            header_text = "Select Additional Lines from the Stanza"

        header_label = tk.Label(
            self.consecutive_window,
            text=header_text,
            bg='dark slate gray',
            fg='white',
            font=('Arial', 16, 'bold'),
            pady=10
        )
        header_label.pack(fill=tk.X)

        frame = tk.Frame(self.consecutive_window, bg='light gray')
        frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)

        canvas = tk.Canvas(frame, bg='light gray', borderwidth=0)
        vsb = tk.Scrollbar(frame, orient="vertical", command=canvas.yview)
        scroll_frame = tk.Frame(canvas, bg='light gray')

        canvas.configure(yscrollcommand=vsb.set)
        canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        vsb.pack(side=tk.RIGHT, fill=tk.Y)

        canvas.create_window((0, 0), window=scroll_frame, anchor="nw")

        # Populate with checkboxes for each consecutive line.
        # Highlight the main verse (pre-selected and disabled) and add normal checkboxes for others.
        self.stanza_checkvars = []
        for idx, line_info in enumerate(stanza_lines):
            line_text = line_info.get('Verse', '')
            if line_text.strip() == main_verse_text.strip():
                # Highlight the main verse
                var = tk.BooleanVar(value=True)
                chk = tk.Checkbutton(
                    scroll_frame,
                    text=line_text,
                    variable=var,
                    bg='yellow',           # highlight color
                    font=('Arial', 12, 'bold'),
                    anchor='w',
                    justify=tk.LEFT,
                    wraplength=800,
                    state='disabled',      # force it to remain selected
                    selectcolor='light blue'
                )
            else:
                var = tk.BooleanVar(value=False)
                chk = tk.Checkbutton(
                    scroll_frame,
                    text=line_text,
                    variable=var,
                    bg='light gray',
                    font=('Arial', 12),
                    anchor='w',
                    justify=tk.LEFT,
                    wraplength=800,
                    selectcolor='light blue'
                )
            chk.pack(fill=tk.X, padx=10, pady=5)
            self.stanza_checkvars.append((var, line_text))

        scroll_frame.update_idletasks()
        canvas.config(scrollregion=canvas.bbox("all"))

        # ---------------------------
        # Button Frame: Submit, Cancel, and Back
        # ---------------------------
        btn_frame = tk.Frame(self.consecutive_window, bg='light gray')
        btn_frame.pack(pady=10)

        tk.Button(
            btn_frame,
            text="Submit",
            command=lambda: self.validate_and_submit_consecutive(main_verse_text),
            font=('Arial', 12, 'bold'),
            bg='navy',
            fg='white',
            padx=20,
            pady=10
        ).pack(side=tk.LEFT, padx=10)

        tk.Button(
            btn_frame,
            text="Cancel",
            command=self.consecutive_window.destroy,
            font=('Arial', 12, 'bold'),
            bg='red',
            fg='white',
            padx=20,
            pady=10
        ).pack(side=tk.LEFT, padx=10)

        tk.Button(
            btn_frame,
            text="Back",
            command=self.back_to_sggs_matches_option,
            font=('Arial', 12, 'bold'),
            bg='gray',
            fg='white',
            padx=20,
            pady=10
        ).pack(side=tk.LEFT, padx=10)

        print("Consecutive verses window created and populated.")

Here is the values of various variables in this function:
stanza_lines = [{'S. No.': 180, 'Verse': 'ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥', 'Verse No.': 180, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥'}, {'S. No.': 181, 'Verse': 'ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥', 'Verse No.': 181, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥'}, {'S. No.': 182, 'Verse': 'ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥', 'Verse No.': 182, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥'}, {'S. No.': 183, 'Verse': 'ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥', 'Verse No.': 183, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥'}, {'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'}, {'S. No.': 185, 'Verse': 'ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥', 'Verse No.': 185, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥'}, {'S. No.': 186, 'Verse': 'ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥', 'Verse No.': 186, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥'}, {'S. No.': 187, 'Verse': 'ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥', 'Verse No.': 187, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥'}, {'S. No.': 188, 'Verse': 'ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥', 'Verse No.': 188, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥'}, {'S. No.': 189, 'Verse': 'ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥', 'Verse No.': 189, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥'}, {'S. No.': 190, 'Verse': 'ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥', 'Verse No.': 190, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥'}, {'S. No.': 191, 'Verse': 'ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥', 'Verse No.': 191, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥'}, {'S. No.': 192, 'Verse': 'ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥', 'Verse No.': 192, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥'}, {'S. No.': 193, 'Verse': 'ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥', 'Verse No.': 193, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥'}, {'S. No.': 194, 'Verse': 'ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥', 'Verse No.': 194, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥'}, {'S. No.': 195, 'Verse': 'ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥', 'Verse No.': 195, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 5, 'NormalizedVerse': 'ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥'}, {'S. No.': 196, 'Verse': 'ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥', 'Verse No.': 196, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 5, 'NormalizedVerse': 'ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥'}, {'S. No.': 197, 'Verse': 'ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥', 'Verse No.': 197, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Stanza End', 'Page Number': 5, 'NormalizedVerse': 'ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥'}]
self.last_user_input = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'



6.
    def fetch_stanza_lines(self, chosen_match):
        """
        Return a list of dictionaries representing consecutive lines from either the current stanza or the entire text set,
        based on the user's choice.
        This function uses the SGGS data loaded by load_sggs_data() (stored in self.sggs_data).
        """
        # Ensure the SGGS data is loaded
        if not hasattr(self, 'sggs_data'):
            self.load_sggs_data()

        # Retrieve the Stanza No. and Text Set No. from the chosen match.
        stanza_no = chosen_match.get('Stanza No.')
        text_set_no = chosen_match.get('Text Set No.')

        if stanza_no is None or text_set_no is None:
            print("Chosen match does not contain required 'Stanza No.' or 'Text Set No.' information.")
            return []

        # Get the Special Type Demonstrator value.
        special_type = chosen_match.get('Special Type Demonstrator', '')

        # If it's 'ਸ਼ਲੋਕ', then we don't ask the user because a ਸ਼ਲੋਕ is always a stanza.
        if special_type == 'ਸ਼ਲੋਕ':
            choice = False
        else:
            choice = messagebox.askyesno(
                "Select Verses",
                f"Do you want to fetch verses from the entire '{special_type}'?\n\n"
                f"(Yes = Entire '{special_type}', No = Only the current Stanza)"
            )
        # Store the user's choice for later use
        self.verses_choice = choice

        if choice:
            # User selected the entire text set.
            subset = self.sggs_data[self.sggs_data['Text Set No.'] == text_set_no]
        else:
            # User selected only the current stanza.
            subset = self.sggs_data[
                (self.sggs_data['Stanza No.'] == stanza_no) &
                (self.sggs_data['Text Set No.'] == text_set_no)
            ]

        # Optionally sort by 'Verse No.' if available
        if 'Verse No.' in subset.columns:
            subset = subset.sort_values(by='Verse No.')

        lines = subset.to_dict(orient='records')

        return lines

Here is the values of various variables in this function:
stanza_no = 22
text_set_no = 1
special_type = 'ਸ਼ਬਦ'
subset =      S. No.                                        Verse  ...  Page Number                              NormalizedVerse
179     180                     ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥  ...            4                     ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥
180     181                     ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥  ...            4                     ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥
181     182                   ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥  ...            4                   ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥
182     183                      ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥  ...            4                      ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥
183     184                   ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥  ...            4                   ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥
184     185                   ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥  ...            4                   ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥
185     186                      ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥  ...            4                      ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥
186     187                     ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥  ...            4                     ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥
187     188  ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥  ...            4  ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥
188     189      ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥  ...            4      ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥
189     190       ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥  ...            4       ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥
190     191     ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥  ...            4     ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥
191     192    ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥  ...            4    ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥
192     193         ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥  ...            4         ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥
193     194   ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥  ...            4   ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥
194     195       ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥  ...            5       ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥
195     196         ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥  ...            5         ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥
196     197    ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥  ...            5    ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥

[18 rows x 16 columns]

lines = [{'S. No.': 180, 'Verse': 'ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥', 'Verse No.': 180, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਤੀਰਥੁ ਤਪੁ ਦਇਆ ਦਤੁ ਦਾਨੁ ॥'}, {'S. No.': 181, 'Verse': 'ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥', 'Verse No.': 181, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਜੇ ਕੋ ਪਾਵੈ ਤਿਲ ਕਾ ਮਾਨੁ ॥'}, {'S. No.': 182, 'Verse': 'ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥', 'Verse No.': 182, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸੁਣਿਆ ਮੰਨਿਆ ਮਨਿ ਕੀਤਾ ਭਾਉ ॥'}, {'S. No.': 183, 'Verse': 'ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥', 'Verse No.': 183, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਅੰਤਰਗਤਿ ਤੀਰਥਿ ਮਲਿ ਨਾਉ ॥'}, {'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'}, {'S. No.': 185, 'Verse': 'ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥', 'Verse No.': 185, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵਿਣੁ ਗੁਣ ਕੀਤੇ ਭਗਤਿ ਨ ਹੋਇ ॥'}, {'S. No.': 186, 'Verse': 'ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥', 'Verse No.': 186, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸੁਅਸਤਿ ਆਥਿ ਬਾਣੀ ਬਰਮਾਉ ॥'}, {'S. No.': 187, 'Verse': 'ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥', 'Verse No.': 187, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸਤਿ ਸੁਹਾਣੁ ਸਦਾ ਮਨਿ ਚਾਉ ॥'}, {'S. No.': 188, 'Verse': 'ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥', 'Verse No.': 188, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਵਣੁ ਸੁ ਵੇਲਾ ਵਖਤੁ ਕਵਣੁ ਕਵਣ ਥਿਤਿ ਕਵਣੁ ਵਾਰੁ ॥'}, {'S. No.': 189, 'Verse': 'ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥', 'Verse No.': 189, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਵਣਿ ਸਿ ਰੁਤੀ ਮਾਹੁ ਕਵਣੁ ਜਿਤੁ ਹੋਆ ਆਕਾਰੁ ॥'}, {'S. No.': 190, 'Verse': 'ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥', 'Verse No.': 190, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵੇਲ ਨ ਪਾਈਆ ਪੰਡਤੀ ਜਿ ਹੋਵੈ ਲੇਖੁ ਪੁਰਾਣੁ ॥'}, {'S. No.': 191, 'Verse': 'ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥', 'Verse No.': 191, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਵਖਤੁ ਨ ਪਾਇਓ ਕਾਦੀਆ ਜਿ ਲਿਖਨਿ ਲੇਖੁ ਕੁਰਾਣੁ ॥'}, {'S. No.': 192, 'Verse': 'ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥', 'Verse No.': 192, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਥਿਤਿ ਵਾਰੁ ਨਾ ਜੋਗੀ ਜਾਣੈ ਰੁਤਿ ਮਾਹੁ ਨਾ ਕੋਈ ॥'}, {'S. No.': 193, 'Verse': 'ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥', 'Verse No.': 193, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਜਾ ਕਰਤਾ ਸਿਰਠੀ ਕਉ ਸਾਜੇ ਆਪੇ ਜਾਣੈ ਸੋਈ ॥'}, {'S. No.': 194, 'Verse': 'ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥', 'Verse No.': 194, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਕਿਵ ਕਰਿ ਆਖਾ ਕਿਵ ਸਾਲਾਹੀ ਕਿਉ ਵਰਨੀ ਕਿਵ ਜਾਣਾ ॥'}, {'S. No.': 195, 'Verse': 'ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥', 'Verse No.': 195, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 5, 'NormalizedVerse': 'ਨਾਨਕ ਆਖਣਿ ਸਭੁ ਕੋ ਆਖੈ ਇਕ ਦੂ ਇਕੁ ਸਿਆਣਾ ॥'}, {'S. No.': 196, 'Verse': 'ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥', 'Verse No.': 196, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 5, 'NormalizedVerse': 'ਵਡਾ ਸਾਹਿਬੁ ਵਡੀ ਨਾਈ ਕੀਤਾ ਜਾ ਕਾ ਹੋਵੈ ॥'}, {'S. No.': 197, 'Verse': 'ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥', 'Verse No.': 197, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Stanza End', 'Page Number': 5, 'NormalizedVerse': 'ਨਾਨਕ ਜੇ ਕੋ ਆਪੌ ਜਾਣੈ ਅਗੈ ਗਇਆ ਨ ਸੋਹੈ ॥ ੨੧ ॥'}]

After the 'self.show_consecutive_verses_option(chosen_match, final_input)' within 'handle_sggs_option_submit(self)' is executed, the user selects from 'Select Additional Lines from the Stanz' window the required verses for analysis, we'll need only verse whosetranslation, flags & word's gammer eds be modified. On clicking on the 'Submit' button Here, the 'validate_and_submit_consecutive' function comes into action to check if multiple verse are selected then there order is consecutive! The 'validate_and_submit_consecutive' fires 'handle_consecutive_submit' function.
7.
    def handle_consecutive_submit(self, main_verse_text):
        """
        Combine the main verse text with the lines selected by the user,
        then proceed with grammar analysis. Ensures that the main verse is
        not duplicated if it was also selected by the user.
        Also, store the individual selected verses in self.selected_verses 
        (as a list of tuples: (start_index, end_index, verse_text)) for later use.
        """
        # Strip the main verse text
        main_line = main_verse_text.strip()

        # Gather the lines that were checked; strip extra whitespace
        selected_lines = [line.strip() for var, line in self.stanza_checkvars if var.get()]

        # Store each selected line as an individual verse in self.selected_verses.
        self.selected_verses = list(selected_lines)

        # Keep only matches where the verse is in self.selected_verses.
        self.chosen_match = [match for match in self.chosen_match if match['Verse'] in self.selected_verses]

        # Filter out any line that is exactly the same as the main verse
        extra_lines = [line for line in selected_lines if line != main_line]

        # Combine all selected lines (including the main verse, already in correct order) into a single string,
        # ensuring the original sequence of the verse is maintained.
        if extra_lines:
            combined_text = " ".join(selected_lines)
        else:
            combined_text = main_line
        
        # Close the consecutive window
        self.consecutive_window.destroy()

        # Proceed with grammar analysis using the combined text
        self.finish_grammar_analysis(combined_text)

Here is the values of various variables in this function:
main_line = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'
selected_lines = ['ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥']
self.selected_verses = ['ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥']
self.chosen_match = [{'S. No.': 184, 'Verse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥', 'Verse No.': 184, 'Stanza No.': 22, 'Text Set No.': 1, 'Raag (Fixed)': nan, 'Sub-Raag': nan, 'Writer (Fixed)': 'ਮਹਲਾ ੧', 'Verse Configuration (Optional)': nan, 'Stanza Configuration (Optional)': nan, 'Bani Name': 'ਜਪੁ', 'Musical Note Configuration': nan, 'Special Type Demonstrator': 'ਸ਼ਬਦ', 'Type': 'Simple', 'Page Number': 4, 'NormalizedVerse': 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'}]
Its worth mentioning here that, 'self.chosen_match' at this point has verything we need!
combined_text = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'

8.
    def finish_grammar_analysis(self, user_input):
        """
        Runs grammar analysis after the user has selected or typed a final verse.
        """
        self.pankti_words = user_input.split()
        self.accumulate_pankti_data(user_input)
        self.current_word_index = 0
        self.all_new_entries = []  # Reset global accumulator

        self.update_navigation_buttons()
        self.process_next_word()

Here is the values of various variables in this function:
self.pankti_words = ['ਸਭਿ', 'ਗੁਣ', 'ਤੇਰੇ', 'ਮੈ', 'ਨਾਹੀ', 'ਕੋਇ', '॥']
I think we can leverage this to targt the words whosegrammar the usr wants to modify!
 
9.
    def update_navigation_buttons(self):
        """Enable or disable navigation buttons based on the current word index."""
        print(f"Updating buttons, current index: {self.current_word_index}, total words: {len(self.pankti_words)}")
        
        # Disable 'Previous' button if at the start
        if self.current_word_index <= 0:
            self.prev_button.config(state=tk.DISABLED)
        else:
            self.prev_button.config(state=tk.NORMAL)
        
        # Disable 'Next' button if at the end
        if self.current_word_index >= len(self.pankti_words) - 1:
            self.next_button.config(state=tk.DISABLED)
        else:
            self.next_button.config(state=tk.NORMAL)

10.
    def process_next_word(self):
        """Process the next valid word or prompt for saving if finished."""
        pankti = " ".join(self.pankti_words)
        self.current_pankti = pankti

        if self.current_word_index < len(self.pankti_words):
            word = self.pankti_words[self.current_word_index]
            if self.is_non_word_character(word):
                self.current_word_index += 1  # Skip non-word characters
                self.process_next_word()
            else:
                self.fetch_data(word, pankti)  # Process current word
        else:
            # All words processed—prompt to save using the global accumulator
            self.save_results_btn.config(state=tk.NORMAL)
            self.prompt_save_results(self.all_new_entries)

Here is the values of various variables in this function:
pankti = 'ਸਭਿ ਗੁਣ ਤੇਰੇ ਮੈ ਨਾਹੀ ਕੋਇ ॥'

11.
    def fetch_data(self, word, pankti):
        try:
            self.reset_input_variables()  # Reset selections for the new word
            print(f"Opening input window for {word}")

            self.user_input(word, pankti)  # Opens the input window with the Pankti

            # Check if input_window exists before waiting
            if hasattr(self, 'input_window') and self.input_window.winfo_exists():
                self.root.wait_window(self.input_window)  # Wait for the input window to close
            else:
                print(f"Input window for {word} did not open properly.")
                return  # Exit if the input window was not opened

            print(f"Input window for {word} closed")

            if not self.input_submitted:
                print(f"No input submitted for {word}. Skipping to next word.")
                self.current_word_index += 1
                self.process_next_word()
            else:
                # Process the submitted input
                self.handle_submitted_input(word)

        except Exception as e:
            print(f"An error occurred while fetching data for {word}: {str(e)}")
            # Ensure the input window is closed in case of an error
            if hasattr(self, 'input_window') and self.input_window.winfo_exists():
                try:
                    self.input_window.destroy()
                except Exception as close_error:
                    print(f"Failed to close input window: {str(close_error)}")
            # Optionally, log the error to a file for future debugging
            with open("error_log.txt", "a", encoding="utf-8") as log_file:
                log_file.write(f"Error with word '{word}': {str(e)}\n")

Here is the values of various variables in this function:


12.
    def user_input(self, word, pankti):
        print(f"Opening input window for {word}")
        self.input_submitted = False

        self.input_window = tk.Toplevel(self.root)
        self.input_window.title(f"Input for {word}")
        self.input_window.configure(bg='light gray')
        self.input_window.state('zoomed')
        self.input_window.resizable(True, True)

        # ---------------------------
        # Display the Pankti on top
        # ---------------------------
        pankti_frame = tk.Frame(self.input_window, bg='light gray')
        pankti_frame.pack(fill=tk.X, padx=20, pady=10)

        pankti_display = tk.Text(
            pankti_frame, wrap=tk.WORD, bg='light gray', font=('Arial', 32),
            height=2, padx=5, pady=5
        )
        pankti_display.pack(fill=tk.X, expand=False)
        pankti_display.insert(tk.END, pankti)
        pankti_display.tag_add("center", "1.0", "end")
        pankti_display.tag_configure("center", justify='center')

        # Highlight the word at self.current_word_index
        words = pankti.split()
        start_idx = 0
        for i, w in enumerate(words):
            # When we reach the word at current_word_index, calculate its start/end
            if i == self.current_word_index:
                end_idx = start_idx + len(w)
                pankti_display.tag_add("highlight", f"1.{start_idx}", f"1.{end_idx}")
                pankti_display.tag_config("highlight", foreground="red", font=('Arial', 32, 'bold'))
                break
            # Move the start index past this word plus one space
            start_idx += len(w) + 1

        pankti_display.config(state=tk.DISABLED)

        # ---------------------------
        # Create a horizontal PanedWindow for split layout
        # ---------------------------
        split_pane = tk.PanedWindow(self.input_window, orient=tk.HORIZONTAL, bg='light gray')
        split_pane.pack(fill=tk.BOTH, expand=True)

        # Left pane: Meanings
        self.left_pane = tk.Frame(split_pane, bg='light gray')
        split_pane.add(self.left_pane, stretch="always")
        tk.Label(self.left_pane, text=f"Meanings for {word}:", bg='light gray',
                font=('Arial', 14, 'bold')).pack(anchor='center', pady=(0, 10))
        self.meanings_scrollbar = tk.Scrollbar(self.left_pane, orient=tk.VERTICAL)
        self.meanings_scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
        self.meanings_canvas = tk.Canvas(self.left_pane, bg='light gray', borderwidth=0,
                                        yscrollcommand=self.meanings_scrollbar.set)
        self.meanings_canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        self.meanings_scrollbar.config(command=self.meanings_canvas.yview)
        self.meanings_inner_frame = tk.Frame(self.meanings_canvas, bg='light gray')
        self.meanings_canvas.create_window((0, 0), window=self.meanings_inner_frame, anchor='nw')

        # Right pane: Grammar Options
        right_pane = tk.Frame(split_pane, bg='light gray')
        split_pane.add(right_pane, stretch="always")
        tk.Label(right_pane, text="Select Grammar Options:", bg='light gray',
                font=('Arial', 14, 'bold')).pack(pady=10)
        self.setup_options(
            right_pane,
            "Do you know the Number of the word?",
            [("Singular", "Singular / ਇਕ"), ("Plural", "Plural / ਬਹੁ"), ("Not Applicable", "NA")],
            self.number_var
        )
        self.setup_options(
            right_pane,
            "Do you know the Gender of the word?",
            [("Masculine", "Masculine / ਪੁਲਿੰਗ"), ("Feminine", "Feminine / ਇਸਤਰੀ"), ("Neutral", "Trans / ਨਪੁਂਸਕ")],
            self.gender_var
        )
        self.setup_options(
            right_pane,
            "Do you know the Part of Speech for the word?",
            [("Noun", "Noun / ਨਾਂਵ"), ("Adjective", "Adjectives / ਵਿਸ਼ੇਸ਼ਣ"),
            ("Adverb", "Adverb / ਕਿਰਿਆ ਵਿਸੇਸ਼ਣ"), ("Verb", "Verb / ਕਿਰਿਆ"),
            ("Pronoun", "Pronoun / ਪੜਨਾਂਵ"), ("Postposition", "Postposition / ਸੰਬੰਧਕ"),
            ("Conjunction", "Conjunction / ਯੋਜਕ")],
            self.pos_var
        )

        # ---------------------------
        # Bottom Button Frame
        # ---------------------------
        button_frame = tk.Frame(self.input_window, bg='light gray')
        button_frame.pack(pady=20)
        tk.Button(button_frame, text="Submit", command=self.submit_input,
                font=('Arial', 12, 'bold'), bg='navy', fg='white',
                padx=30, pady=15).pack(side=tk.LEFT, padx=15)
        tk.Button(button_frame, text="Skip", command=self.skip_input,
                font=('Arial', 12, 'bold'), bg='navy', fg='white',
                padx=30, pady=15).pack(side=tk.LEFT, padx=15)

        # ---------------------------
        # Launch the dictionary lookup in a separate thread
        # ---------------------------
        self.start_progress()
        threading.Thread(target=self.lookup_meanings_thread, args=(word,), daemon=True).start()

        self.input_window.transient(self.root)
        self.input_window.grab_set()
        self.root.wait_window(self.input_window)
        print(f"Input window for {word} closed")

Here is the values of various variables in this function:

