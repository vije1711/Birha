### Streamlined WSL + Python + Git (SSH) Setup — Optimized & Stable

This refined guide ensures a seamless, repeatable setup for **Ubuntu (WSL) + VS Code + GitHub (SSH) + Python venv**, avoiding cross-OS path, permission, and interpreter issues.

---

### **0. Open the Correct VS Code Window**

1. Close all VS Code instances.
2. Launch Ubuntu and run:
   ```bash
   cd ~
   code .
   ```
   Confirm the VS Code bottom bar reads **WSL: Ubuntu** — all work happens here.

---

### **1. System Preparation (Ubuntu)**

```bash
sudo apt update && sudo apt upgrade -y

# Core dev tools + Python headers
sudo apt install -y build-essential pkg-config python3-dev libffi-dev libssl-dev \
                    libxml2-dev libxslt1-dev zlib1g-dev libjpeg-dev libpng-dev libfreetype6-dev

# venv and Python mapping
sudo apt install -y python3.12-venv python-is-python3

# For tkinter + pyperclip support
sudo apt install -y python3-tk xclip
```

---

### **2. SSH Configuration for GitHub**

```bash
# Generate SSH key (press Enter for defaults)
ssh-keygen -t ed25519 -C "vije1711"

# Secure key permissions
chmod 700 ~/.ssh
chmod 600 ~/.ssh/id_ed25519 ~/.ssh/id_ed25519.pub

# Start agent + add key
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519

# Display public key (copy this to GitHub → Settings → SSH and GPG Keys)
cat ~/.ssh/id_ed25519.pub
```

Create a **~/.ssh/config** file to make SSH seamless:
```bash
mkdir -p ~/.ssh && chmod 700 ~/.ssh
cat > ~/.ssh/config <<'CFG'
Host github.com
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519
  IdentitiesOnly yes
  AddKeysToAgent yes
CFG
chmod 600 ~/.ssh/config
```

---

### **3. SSH Agent Persistence (Auto-load key)**

Add this to **~/.profile** and **~/.bashrc** (once per file):
```bash
# Persistent SSH agent socket
export SSH_AUTH_SOCK="$HOME/.ssh/ssh-agent.sock"
if ! [ -S "$SSH_AUTH_SOCK" ]; then
  eval "$(ssh-agent -a "$SSH_AUTH_SOCK")" >/dev/null 2>&1
fi
# Add key only in interactive shells
if [ -t 0 ] && ! ssh-add -l >/dev/null 2>&1; then
  ssh-add ~/.ssh/id_ed25519
fi

# Keychain reattachment
if command -v keychain >/dev/null 2>&1; then
  eval "$(keychain --quiet --agents ssh --eval id_ed25519)"
fi
```
Then reload:
```bash
source ~/.profile
source ~/.bashrc
```

Install Keychain (optional but recommended):
```bash
sudo apt install -y keychain
```

---

### **4. Project Setup (Linux Filesystem)**

> ⚠️ Avoid working in `/mnt/c/...` for better performance.

```bash
mkdir -p ~/Projects
cd ~/Projects
git clone git@github.com:vije1711/Birha.git "2.1 Main Software"
cd "2.1 Main Software"
```

---

### **5. Python Virtual Environment Setup**

```bash
rm -rf .venv  # clean old Windows-style envs
python3 -m venv .venv
source .venv/bin/activate
python -m pip install -U pip setuptools wheel
```

---

### **6. Install Dependencies**

```bash
cat > requirements.txt <<'REQ'
numpy==2.3.3
openpyxl==3.1.5
pandas==2.3.3
pyperclip==1.11.0
rapidfuzz==3.14.1
REQ

# Note: transitive deps like python-dateutil, tzdata, et_xmlfile are installed automatically.
pip install -r requirements.txt
```

---

### **7. VS Code Workspace Settings**

Create `.vscode/settings.json`:
```json
{
  "python.defaultInterpreterPath": "/home/vije1711/Projects/2.1 Main Software/.venv/bin/python3.12",
  "python.terminal.activateEnvironment": true,
  "terminal.integrated.defaultProfile.linux": "bash",
  "git.path": "/usr/bin/git",
  "git.ssh": "/usr/bin/ssh",
  "python.analysis.extraPaths": [
    "/home/vije1711/Projects/2.1 Main Software/.venv/lib/python3.12/site-packages"
  ],
  "terminal.integrated.cwd": "/home/vije1711/Projects/2.1 Main Software"
}
```
Reload VS Code: `Ctrl + Shift + P → Developer: Reload Window`.  
Open a new terminal — it should display `(.venv)`.

---

### **8. Git Configuration**

```bash
git config --global user.name "Vijendra Singh"
git config --global user.email "your_github_email@example.com"
git config --global push.autoSetupRemote true
git config --global alias.st 'status -sb'
git config --global alias.lg "log --oneline --graph --decorate --all --max-count=30"
```

Create and push a new branch:
```bash
git checkout -b feature/axiom-dashboard-entry
git push -u origin feature/axiom-dashboard-entry
```

---

### **9. Validation Commands**

```bash
which python
python -c "import sys; print(sys.executable)"
python - <<'PY'
import pyperclip, rapidfuzz, pandas, openpyxl, numpy
print('All good — RapidFuzz', rapidfuzz.__version__)
PY

ssh -T git@github.com  # should say "Hi vije1711!"
git pull --rebase --autostash
git push
```

---

### **10. Maintenance & Recovery**

```bash
# Clean obsolete packages
sudo apt autoremove -y

# Rotate SSH keys
ssh-add -D && ssh-add ~/.ssh/id_ed25519

# Reconfirm upstream
git branch -vv | grep main
```

If you reboot:
```bash
wsl.exe -e bash -lc "ssh-add -l"  # should show your ED25519 fingerprint
```
If it doesn’t, run once:
```bash
source ~/.profile
```

---

### **11. .gitignore (Recommended)**
Create a `.gitignore` in your repo root:
```gitignore
.venv/
__pycache__/
*.pyc
.ipynb_checkpoints/
.env
.DS_Store
```

---

### **12. Troubleshooting & Recovery**

**Interpreter / Pylance warnings**  
- Make sure the status bar shows the venv path ending with `/.venv/bin/python3.12`.  
- `Ctrl+Shift+P → Python: Select Interpreter` → pick the venv.  
- `Ctrl+Shift+P → Pylance: Restart language server`.

**Windows-style venv artifacts (e.g., `.venv/Script(s)`):**  
```bash
rm -rf .venv
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

**Remote has commits you don’t (non-fast-forward):**  
_Rebase (clean history):_
```bash
git fetch origin
git pull --rebase origin $(git rev-parse --abbrev-ref HEAD)
# resolve conflicts → git add <files> → git rebase --continue
# then
git push --force-with-lease
```
_Merge (no history rewrite):_
```bash
git fetch origin
git merge origin/$(git rev-parse --abbrev-ref HEAD)
git push
```

**Multiple upstreams on `main`:**  
```bash
git config --local --unset-all branch.main.remote || true
git config --local --unset-all branch.main.merge || true
git branch --set-upstream-to=origin/main main
```

**SSH agent prompts keep returning:**  
- Ensure the fixed-socket block exists once in **both** `~/.profile` and `~/.bashrc`.  
- New shell test (from Windows): `wsl.exe -e bash -lc "ssh-add -l"` should list your key.  
- If not, run once interactively: `ssh-add ~/.ssh/id_ed25519`.

**OneDrive/`/mnt/c` performance issues:**  
- Work inside `~/Projects/...` (Linux filesystem).  
- Large pip installs/builds are significantly faster there.

---

### ✅ **Final State Checklist**
- Working in WSL Ubuntu, Linux filesystem (not `/mnt/c`).
- `.venv` active; `which python` → project’s `/.venv/bin/python3.12`.
- `ssh-add -l` shows ED25519 fingerprint in new shells (and `wsl.exe` one-liners).
- `ssh -T git@github.com` prints "Hi vije1711!".
- `git pull`/`git push` run without prompts.
- VS Code uses bash and the pinned interpreter for this workspace.

---

**Result:** Stable, fast, reproducible WSL workflow — persistent SSH agent, Linux-native venv, and frictionless Git/VS Code integration.



---

## Appendix A — Troubleshooting Matrix

**Issue** | **Symptom** | **Fix**
---|---|---
VS Code opened in Windows mode | Bottom bar lacks *WSL: Ubuntu*; terminal shows `PS Microsoft.PowerShell...` | Close all windows → open from WSL: `cd ~/Projects/"2.1 Main Software" && code .` → Status bar must say **WSL: Ubuntu**.
Wrong Python interpreter | Pylance shows `reportMissingImports` for installed libs | Ctrl+Shift+P → **Python: Select Interpreter** → pick `.../.venv/bin/python3.12` → Ctrl+Shift+P → **Pylance: Restart language server**.
Mixed Windows/Linux venv | `.venv/Scripts/activate` exists, not `bin/activate` | `deactivate; rm -rf .venv; python3 -m venv .venv; source .venv/bin/activate`.
Pip build errors | Errors about headers or wheels | `sudo apt install -y build-essential pkg-config python3-dev libffi-dev libssl-dev libxml2-dev libxslt1-dev python3-tk` then reinstall.
Clipboard errors (pyperclip) | `PyperclipException` | `sudo apt install -y xclip` (X11) or `sudo apt install -y wl-clipboard` (Wayland).
Tkinter import error | `ModuleNotFoundError: _tkinter` | `sudo apt install -y python3-tk`.
SSH permission denied | `Permission denied (publickey)` | Ensure WSL window; `~/.ssh/config` exists (see guide); run `ssh -T git@github.com`.
Upstream ambiguity | `multiple upstream branches` | Run the *Clean upstream* block in this doc (Section **Git: clean upstream**).
Rebase required | Push rejected: *fetch first* | `git pull --rebase origin <branch>` → resolve → `git push --force-with-lease` (solo) or `git merge` then `git push` (team).
Agent not found in fresh shells | `Could not open a connection to your authentication agent.` | Ensure **fixed socket** block present in `~/.profile` and `~/.bashrc`; verify `echo "$SSH_AUTH_SOCK"` → `/home/.../.ssh/ssh-agent.sock`.

> Tip: run `python -m pip check` to catch dependency conflicts quickly.

---

## Appendix B — Quality-of-Life & Project Hygiene

### `.gitignore` (Python)
```gitignore
.venv/
__pycache__/
*.pyc
.ipynb_checkpoints/
.env
.DS_Store
```

### Helpful Git aliases
```bash
git config --global alias.st 'status -sb'
git config --global alias.lg "log --oneline --graph --decorate --all --max-count=30"
```

### Optional: auto-activate venv on `cd` (shell-only)
Append to **~/.bashrc**:
```bash
# Auto-activate local venv when entering a folder
activate_venv() { [ -f "./.venv/bin/activate" ] && source ./.venv/bin/activate; }
prompt_command() { activate_venv; }
PROMPT_COMMAND=prompt_command
```
*(VS Code already auto-activates via settings; this helps plain terminals.)*

### Optional: use `pip-tools` to manage locked deps
```bash
pip install pip-tools
cat > requirements.in <<'IN'
numpy
openpyxl
pandas
pyperclip
rapidfuzz
IN
pip-compile --generate-hashes -o requirements.txt
pip-sync requirements.txt
```

---

## Appendix C — Branching & Sync Cheatsheet

```bash
# Create & publish a feature branch
git checkout -b feature/my-change
git push -u origin feature/my-change

# Keep your branch current (clean history)
git fetch origin
git pull --rebase origin main   # while on your feature branch

# Merge main into your branch (no history rewrite)
git merge origin/main

# Safe force-push after rebase (solo branches)
git push --force-with-lease
```

---

## Appendix D — Moving a Repo from Windows to WSL (preserve history)

```bash
# 1) In Windows, ensure all changes are committed & pushed
# 2) In WSL, clone fresh to Linux FS
cd ~/Projects
git clone git@github.com:vije1711/Birha.git "2.1 Main Software"
cd "2.1 Main Software"
python3 -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
```

---

## Appendix E — Post‑Reboot Health Check (quick)

```bash
wsl.exe -e bash -lc "ssh-add -l"   # shows ED25519 fingerprint
cd ~/Projects/"2.1 Main Software"
source .venv/bin/activate
which python && python -V
ssh -T git@github.com
```

---

## Appendix F — VS Code Tips

- Install the **Python** and **Remote - WSL** extensions in the WSL window.
- If Pylance still flags compiled wheels (e.g., RapidFuzz), you can soften diagnostics:
```json
"python.analysis.diagnosticSeverityOverrides": {
  "reportMissingModuleSource": "none"
}
```
- Ensure the terminal profile is **bash**: `"terminal.integrated.defaultProfile.linux": "bash"`.

---

## Appendix G — Safe Edits to `.git/config` (when needed)

Ensure a single branch block for main:
```
[branch "main"]
    remote = origin
    merge = refs/heads/main
```
If broken: backup then edit:
```bash
cp .git/config .git/config.backup
nano .git/config
```

---

**You’re squared away.** These appendices fold in the extra pieces you’d jotted down earlier (agent persistence, recovery paths, rebase/merge choices, venv auto-activation, pip-tools, .gitignore, and migration from Windows). If you want this exported as a PDF/Markdown for sharing, I can generate that too.

